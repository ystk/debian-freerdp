Backport of:

From 445a5a42c500ceb80f8fa7f2c11f3682538033f3 Mon Sep 17 00:00:00 2001
From: Armin Novak <armin.novak@thincast.com>
Date: Mon, 22 Oct 2018 16:25:13 +0200
Subject: [PATCH] Fixed CVE-2018-8786

Thanks to Eyal Itkin from Check Point Software Technologies.
---
 libfreerdp/core/update.c | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

Index: freerdp-1.1.0~git20140921.1.440916e+dfsg1/libfreerdp/core/update.c
===================================================================
--- freerdp-1.1.0~git20140921.1.440916e+dfsg1.orig/libfreerdp/core/update.c
+++ freerdp-1.1.0~git20140921.1.440916e+dfsg1/libfreerdp/core/update.c
@@ -119,7 +119,7 @@ BOOL update_read_bitmap(rdpUpdate* updat
 
 	if (bitmap_update->number > bitmap_update->count)
 	{
-		UINT16 count;
+		UINT32 count;
 
 		count = bitmap_update->number * 2;
 
